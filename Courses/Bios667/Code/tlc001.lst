1          %let progname = tlc001.sas;
2          * input: tlc.dat
3          * output:
4          * xref:
5          * does: Hotelling's T^2
6                  Profile analysis
7                  Treatment of Lead Exposed Children Trial (TLC)
8          
9          *******************************************************************;
10         title1 "&progname Treatment of Lead Exposed Children (TLC) Trial";
11         
12         filename INF   "tlc.dat";
13         ods pdf file = "tlc001.pdf";
NOTE: Writing ODS PDF output to DISK destination "c:\bios\667\tlc001.pdf", printer "PDF".
14         
15         *******************************************************************;
16         
17         data A;
18           infile INF  firstobs=2;
19           input id group $ lead0 lead1 lead4 lead6;
20           dif1 = lead1 - lead0;
21           dif4 = lead4 - lead0;
22           dif6 = lead6 - lead0;
23         
24           * Using the SAS scaling of the coefficients makes the univariate
25             sample SD equal to 1/sqrt(n-1).
26             Then the univariate t will be t = xbar*sqrt{n(n-1)} and
27             the univariate t^2=xbar^2*n(n-1).
28         
29             Of course, the univariate t^2 = Hotelling's T^2, regardless of the
30             scaling.
31             "coefficients" refers to the optimal ones, S^{-1} (xbar-mu0).
32           ;
33         
2 The SAS System                                             13:09 Wednesday, September 6, 2017

34           if (group = "P") then
35           ay =
36            -0.0108130163 * dif1
37            -0.0195638415 * dif4
38            -0.0195823747 * dif6;
39           else  /* group = "A" */
40           ay =
41            -0.0161850617 * dif1
42            -0.0043244324 * dif4
43            -0.0000215889 * dif6;
44            label ay = "A linear combination that maximizes the univariate t^2";
45         
46           run;

NOTE: The infile INF is:
      Filename=c:\bios\667\tlc.dat,
      RECFM=V,LRECL=32767,File Size (bytes)=4546,
      Last Modified=01Feb2017:14:56:55,
      Create Time=06Sep2017:13:01:47

NOTE: 100 records were read from the infile INF.
      The minimum record length was 43.
      The maximum record length was 43.
NOTE: The data set WORK.A has 100 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.16 seconds
      cpu time            0.00 seconds
      

47         
48         ***********************************************;
49         
50         title3 "proc IML";
51         
52         proc iml ;
NOTE: IML Ready
53         
54         ***************************************************;
55         start hot1(y, mu0);
56          * Hotelling's T^2 one-sample multivariate test;
57          * y = data matrix, mu0 = column vector;
58         
59           n = nrow(y);
60           d = ncol(y);
61           ybar = t(mean(y));
62           r = ybar - mu0;
63           s = cov(y);
64           a = solve(s, r);
65           t2 = n * (t(r) * a);
65       !                                       * ~ T^2(d, n-1) under H0;
66           t2_df1 = d;
67           t2_df2 = n - 1;
68           f   = t2 * (n - d) / (d * (n - 1));
68       !                                       * ~ F(d, n-d) under H0;
69           f_df1 = d;
70           f_df2 = n - d;
71           pval = 1 - probf(f, f_df1, f_df2);
72           maxroot = t2 / (n - 1);
73         
74           print "Hotelling's T^2 one-sample test";
75           print n d;
76           print ybar s;
77           print "T^2:" ,  t2  t2_df1 t2_df2 ;
3 The SAS System                                             13:09 Wednesday, September 6, 2017

78           print "F:"   ,  f   f_df1  f_df2;
79           print pval;
80           print "The max eigenvalue of E^{-1} H: "  maxroot;
81         
82           print "Coefficients:", a  [format=16.10];
83           a2 = a / sqrt(a[##]);
83       !                              print "Norm=1:", a2 [format=16.10];
84           a3 = a / sqrt(t2*(n-1)/n);
84       !                              print "sas:",    a3 [format=16.10];
85         
86         finish;
NOTE: Module HOT1 defined.
87         ******************************************************;
88         
89         * IML execution starts here;
90         
91         use A;
92         
93         print "Group: A";
94         read all var  {dif1 dif4 dif6} into y where (group = "A");
95         run hot1(y, j(3, 1, 0));
96         
97         print "Group: P";
98         read all var  {dif1 dif4 dif6} into y where (group = "P");
99         run hot1(y, j(3, 1, 0));
100        
101        ******************************************************;
102        
NOTE: Exiting IML.
NOTE: The PROCEDURE IML printed pages 1-3.
NOTE: PROCEDURE IML used (Total process time):
      real time           0.29 seconds
      cpu time            0.03 seconds
      

103        proc sort data = A; by group; run;

NOTE: There were 100 observations read from the data set WORK.A.
NOTE: The data set WORK.A has 100 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

104        * manova in glm;
105        proc glm data = A;
106          model dif1 dif4 dif6 = ;
107          manova h = intercept ;
108          by group;
109          title2 "proc glm";
110          run;

NOTE: Interactivity disabled with BY processing.
NOTE: The PROCEDURE GLM printed pages 4-13.
NOTE: PROCEDURE GLM used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

111        
112        ******************************************************;
113        
114        title2 "Hotelling T^2 = t^2 based on the optimal linear combination";
4 The SAS System                                             13:09 Wednesday, September 6, 2017

115        proc means data = A;
116          var ay;
117          by group;
118          run;

NOTE: There were 100 observations read from the data set WORK.A.
NOTE: The PROCEDURE MEANS printed page 14.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.06 seconds
      cpu time            0.00 seconds
      

119        

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           3.18 seconds
      cpu time            0.28 seconds
      
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                     1
                                                             13:09 Wednesday, September 6, 2017
proc IML

Group: A


Hotelling's T^2 one-sample test


        n         d

       50         3


     ybar         s

  -13.018 53.145996 38.635441 22.724894
  -11.026 38.635441 56.590943 20.108339
   -5.778 22.724894 20.108339 64.733588


T^2:
       t2    t2_df1    t2_df2

163.71839         3        49


F:
        f     f_df1     f_df2

52.345337         3        47


   pval

5.107E-15


                                   maxroot

The max eigenvalue of E^{-1} H:  3.3411917


Coefficients:
        a

   -0.2050105143
   -0.0547760727
   -0.0002734592


Norm=1:
       a2

   -0.9661089543
   -0.2581314158
   -0.0012886722


sas:
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                     2
                                                             13:09 Wednesday, September 6, 2017
proc IML

       a3

   -0.0161850617
   -0.0043244324
   -0.0000215889


Group: P


Hotelling's T^2 one-sample test


        n         d

       50         3


     ybar         s

   -1.612    9.5672 5.2724245 4.4584571
   -2.202 5.2724245 9.8181592 7.7817837
   -2.626 4.4584571 7.7817837 14.213392


T^2:
       t2    t2_df1    t2_df2

30.696303         3        49


F:
        f     f_df1     f_df2

9.8144643         3        47


   pval

0.0000386


                                   maxroot

The max eigenvalue of E^{-1} H:  0.6264552


Coefficients:
        a

   -0.0593065872
   -0.1073025917
   -0.1074042413


Norm=1:
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                     3
                                                             13:09 Wednesday, September 6, 2017
proc IML

       a2

   -0.3638592366
   -0.6583255069
   -0.6589491505


sas:
       a3

   -0.0108130163
   -0.0195638415
   -0.0195823747
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                     4
proc glm                                                     13:09 Wednesday, September 6, 2017

group=A

The GLM Procedure

Number of Observations Read          50
Number of Observations Used          50
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                     5
proc glm                                                     13:09 Wednesday, September 6, 2017

group=A

The GLM Procedure
 
Dependent Variable: dif1   

                                        Sum of
Source                      DF         Squares     Mean Square    F Value    Pr > F

Model                        1      8473.41620      8473.41620     159.44    <.0001

Error                       49      2604.15380        53.14600                     

Uncorrected Total           50     11077.57000                                     


R-Square     Coeff Var      Root MSE     dif1 Mean

0.000000     -56.00038      7.290130     -13.01800


Source                      DF       Type I SS     Mean Square    F Value    Pr > F

Intercept                    1     8473.416200     8473.416200     159.44    <.0001


Source                      DF     Type III SS     Mean Square    F Value    Pr > F

Intercept                    1     8473.416200     8473.416200     159.44    <.0001


                                  Standard
Parameter         Estimate           Error    t Value    Pr > |t|

Intercept     -13.01800000      1.03098008     -12.63      <.0001
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                     6
proc glm                                                     13:09 Wednesday, September 6, 2017

group=A

The GLM Procedure
 
Dependent Variable: dif4   

                                        Sum of
Source                      DF         Squares     Mean Square    F Value    Pr > F

Model                        1     6078.633800     6078.633800     107.41    <.0001

Error                       49     2772.956200       56.590943                     

Uncorrected Total           50     8851.590000                                     


R-Square     Coeff Var      Root MSE     dif4 Mean

0.000000     -68.22687      7.522695     -11.02600


Source                      DF       Type I SS     Mean Square    F Value    Pr > F

Intercept                    1     6078.633800     6078.633800     107.41    <.0001


Source                      DF     Type III SS     Mean Square    F Value    Pr > F

Intercept                    1     6078.633800     6078.633800     107.41    <.0001


                                  Standard
Parameter         Estimate           Error    t Value    Pr > |t|

Intercept     -11.02600000      1.06386976     -10.36      <.0001
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                     7
proc glm                                                     13:09 Wednesday, September 6, 2017

group=A

The GLM Procedure
 
Dependent Variable: dif6   

                                        Sum of
Source                      DF         Squares     Mean Square    F Value    Pr > F

Model                        1     1669.264200     1669.264200      25.79    <.0001

Error                       49     3171.945800       64.733588                     

Uncorrected Total           50     4841.210000                                     


R-Square     Coeff Var      Root MSE     dif6 Mean

0.000000     -139.2475      8.045719     -5.778000


Source                      DF       Type I SS     Mean Square    F Value    Pr > F

Intercept                    1     1669.264200     1669.264200      25.79    <.0001


Source                      DF     Type III SS     Mean Square    F Value    Pr > F

Intercept                    1     1669.264200     1669.264200      25.79    <.0001


                                  Standard
Parameter         Estimate           Error    t Value    Pr > |t|

Intercept     -5.778000000      1.13783644      -5.08      <.0001
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                     8
proc glm                                                     13:09 Wednesday, September 6, 2017

group=A

The GLM Procedure
Multivariate Analysis of Variance

        Characteristic Roots and Vectors of: E Inverse * H, where
                  H = Type III SSCP Matrix for Intercept
                          E = Error SSCP Matrix
 
Characteristic               Characteristic Vector  V'EV=1
          Root    Percent            dif1            dif4            dif6

    3.34119173     100.00      0.01618506      0.00432443      0.00002159
    0.00000000       0.00     -0.00651777     -0.00243926      0.01933949
    0.00000000       0.00     -0.02236489      0.02640541      0.00000000


MANOVA Test Criteria and Exact F Statistics for the Hypothesis of No Overall Intercept Effect
                           H = Type III SSCP Matrix for Intercept
                                    E = Error SSCP Matrix
                                               
                                   S=1    M=0.5    N=22.5
 
Statistic                        Value    F Value    Num DF    Den DF    Pr > F

Wilks' Lambda               0.23035149      52.35         3        47    <.0001
Pillai's Trace              0.76964851      52.35         3        47    <.0001
Hotelling-Lawley Trace      3.34119173      52.35         3        47    <.0001
Roy's Greatest Root         3.34119173      52.35         3        47    <.0001
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                     9
proc glm                                                     13:09 Wednesday, September 6, 2017

group=P

The GLM Procedure

Number of Observations Read          50
Number of Observations Used          50
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                    10
proc glm                                                     13:09 Wednesday, September 6, 2017

group=P

The GLM Procedure
 
Dependent Variable: dif1   

                                        Sum of
Source                      DF         Squares     Mean Square    F Value    Pr > F

Model                        1     129.9272000     129.9272000      13.58    0.0006

Error                       49     468.7928000       9.5672000                     

Uncorrected Total           50     598.7200000                                     


R-Square     Coeff Var      Root MSE     dif1 Mean

0.000000     -191.8790      3.093089     -1.612000


Source                      DF       Type I SS     Mean Square    F Value    Pr > F

Intercept                    1     129.9272000     129.9272000      13.58    0.0006


Source                      DF     Type III SS     Mean Square    F Value    Pr > F

Intercept                    1     129.9272000     129.9272000      13.58    0.0006


                                  Standard
Parameter         Estimate           Error    t Value    Pr > |t|

Intercept     -1.612000000      0.43742885      -3.69      0.0006
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                    11
proc glm                                                     13:09 Wednesday, September 6, 2017

group=P

The GLM Procedure
 
Dependent Variable: dif4   

                                        Sum of
Source                      DF         Squares     Mean Square    F Value    Pr > F

Model                        1     242.4402000     242.4402000      24.69    <.0001

Error                       49     481.0898000       9.8181592                     

Uncorrected Total           50     723.5300000                                     


R-Square     Coeff Var      Root MSE     dif4 Mean

0.000000     -142.2976      3.133394     -2.202000


Source                      DF       Type I SS     Mean Square    F Value    Pr > F

Intercept                    1     242.4402000     242.4402000      24.69    <.0001


Source                      DF     Type III SS     Mean Square    F Value    Pr > F

Intercept                    1     242.4402000     242.4402000      24.69    <.0001


                                  Standard
Parameter         Estimate           Error    t Value    Pr > |t|

Intercept     -2.202000000      0.44312886      -4.97      <.0001
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                    12
proc glm                                                     13:09 Wednesday, September 6, 2017

group=P

The GLM Procedure
 
Dependent Variable: dif6   

                                        Sum of
Source                      DF         Squares     Mean Square    F Value    Pr > F

Model                        1      344.793800      344.793800      24.26    <.0001

Error                       49      696.456200       14.213392                     

Uncorrected Total           50     1041.250000                                     


R-Square     Coeff Var      Root MSE     dif6 Mean

0.000000     -143.5668      3.770065     -2.626000


Source                      DF       Type I SS     Mean Square    F Value    Pr > F

Intercept                    1     344.7938000     344.7938000      24.26    <.0001


Source                      DF     Type III SS     Mean Square    F Value    Pr > F

Intercept                    1     344.7938000     344.7938000      24.26    <.0001


                                  Standard
Parameter         Estimate           Error    t Value    Pr > |t|

Intercept     -2.626000000      0.53316774      -4.93      <.0001
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                    13
proc glm                                                     13:09 Wednesday, September 6, 2017

group=P

The GLM Procedure
Multivariate Analysis of Variance

        Characteristic Roots and Vectors of: E Inverse * H, where
                  H = Type III SSCP Matrix for Intercept
                          E = Error SSCP Matrix
 
Characteristic               Characteristic Vector  V'EV=1
          Root    Percent            dif1            dif4            dif6

    0.62645517     100.00      0.01081302      0.01956384      0.01958237
    0.00000000       0.00     -0.00682976     -0.05038330      0.04644082
    0.00000000       0.00     -0.05357783      0.03922228      0.00000000


MANOVA Test Criteria and Exact F Statistics for the Hypothesis of No Overall Intercept Effect
                           H = Type III SSCP Matrix for Intercept
                                    E = Error SSCP Matrix
                                               
                                   S=1    M=0.5    N=22.5
 
Statistic                        Value    F Value    Num DF    Den DF    Pr > F

Wilks' Lambda               0.61483404       9.81         3        47    <.0001
Pillai's Trace              0.38516596       9.81         3        47    <.0001
Hotelling-Lawley Trace      0.62645517       9.81         3        47    <.0001
Roy's Greatest Root         0.62645517       9.81         3        47    <.0001
tlc001.sas Treatment of Lead Exposed Children (TLC) Trial                                    14
Hotelling T^2 = t^2 based on the optimal linear combination  13:09 Wednesday, September 6, 2017

group=A

The MEANS Procedure

Analysis Variable : ay A linear combination that maximizes the univariate t^2
 
  N            Mean         Std Dev         Minimum         Maximum
-------------------------------------------------------------------
 50       0.2585031       0.1428571      -0.0440816       0.5522225
-------------------------------------------------------------------


group=P

Analysis Variable : ay A linear combination that maximizes the univariate t^2
 
  N            Mean         Std Dev         Minimum         Maximum
-------------------------------------------------------------------
 50       0.1119335       0.1428571      -0.2966099       0.4679819
-------------------------------------------------------------------
